# GPARTNER V2 ‚Äî MASTER EXECUTION SPEC  
**For Claude Code ‚Äî Senior Enterprise Engineer Mode**  
Version: 1.0  
Date: 2025-12-10  
Author: Aunji & System Architect

---

# üî• OBJECTIVE
‡∏û‡∏±‡∏í‡∏ô‡∏≤ GPARTNER V2 (Partner Reporting + Dashboard + LINE Alerts)  
‡πÇ‡∏î‡∏¢ **‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡πà‡∏≠‡∏ô** ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤ Feature ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ï‡∏≤‡∏°‡πÑ‡∏ü‡∏•‡πå:

- gpartnerv2_10122025.md  
- GPARTNER_REPORTING_MASTER_PLAN.md  
- API_DATA_MAPPING.md  
- UI_PAGE_STRUCTURE.md  
- CLAUDE_CODE_PLAN.md  

‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô  
‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á refactor ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà

---

# üß† CLAUDE WORKING MODE (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô **Claude ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ 3 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏™‡∏°‡∏≠**

### **STEP A ‚Äî READ & ANALYZE CURRENT CODE**
1. ‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô repo:  
   - `/components`  
   - `/composables`  
   - `/pages/backend/*`  
   - `/utils`  
   - `/plugins/useApi.ts`  
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î  
3. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå dependencies ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (Vuetify, SSR, composables structure)

**‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏° 100%**

---

### **STEP B ‚Äî MATCH PLAN WITH EXISTING CODE**
1. ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ú‡∏ô V2 ‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏Å‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ reuse ‡πÑ‡∏î‡πâ  
2. ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà  
3. ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ï‡∏π‡πâ  
4. ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô folder structure ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£

---

### **STEP C ‚Äî EXECUTE PHASE BY PHASE (‡∏´‡πâ‡∏≤‡∏°‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô)**
Claude ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô Phase ‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö:

1. **Phase 0 ‚Äì Code Audit**  
   ‡∏≠‡πà‡∏≤‡∏ô ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏ö‡∏Å‡∏û‡∏£‡πà‡∏≠‡∏á

2. **Phase 1 ‚Äì API Integration Layer**  
   ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô composables ‡πÉ‡∏´‡∏°‡πà‡∏ï‡∏≤‡∏° spec  
   - useDashboard()  
   - useWallet()  
   - useTopupReport()  
   - useUsageReport()  
   - useChargerPerformance()  
   - useLineAlert()  

3. **Phase 2 ‚Äì Data Computing Layer**  
   utils mapping ‚Üí kWh, duration, grouping, reports

4. **Phase 3 ‚Äì UI Pages & Components**

5. **Phase 4 ‚Äì Export Functions (PDF/XLSX)**

6. **Phase 5 ‚Äì LINE Notify Integration**

7. **Phase 6 ‚Äì QA & Cleanup**

**‡∏ó‡∏∏‡∏Å Phase ‡∏ï‡πâ‡∏≠‡∏á commit ‡πÅ‡∏¢‡∏Å ‡πÅ‡∏•‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ä‡∏±‡∏î‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£**

---

# üìÅ NEW FOLDER STRUCTURE (Claude ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á)
```
/composables/reports/
/utils/reports/
/components/reports/
/components/dashboard/
/pages/backend/dashboard.vue
/pages/backend/reports/wallet.vue
/pages/backend/reports/topups.vue
/pages/backend/reports/usage.vue
/pages/backend/reports/charger-performance.vue
/pages/backend/settings/line-connect.vue
```

---

# üîó API USAGE POLICY
Claude ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ API ‡∏à‡∏≤‡∏Å:

```
GET /partner/revenue
GET /partner/revenue/top-up
GET /partner/charge-point
POST /partner/report/income   (‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
POST /partner/report/charger  (‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
```

**‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà partner**

---

# üìä FEATURE REQUIREMENTS (Strict)
‡∏ï‡∏≤‡∏° scope ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ 100% ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô  

### ‚úî Dashboard
- Revenue today / month  
- kWh today / month  
- Sessions count  
- Revenue by charger  
- kWh by charger  
- Peak hour heatmap  
- Charging efficiency  

### ‚úî Wallet
- Total top-up  
- Total usage  
- Outstanding wallet  
- Wallet by user  
- Wallet history (running balance)

### ‚úî Reports
1. Top-up report  
2. Usage report  
3. Charger performance  
4. Top-up vs Usage graph  
5. Export XLSX/PDF  

### ‚úî LINE Notify
- Button: Connect LINE Notify  
- Save token  
- Poll API every 30‚Äì60s  
- Detect status change ‚Üí send notify  

### ‚úò Removed / Not Implemented
- Payment Gateway Fee  
- TOU / FT  
- Error log history  
- VAT report  
- Promotion usage  

---

# üöÄ CLAUDE CODE EXECUTION RULES
1. **‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏ö‡∏ö enterprise-grade**  
2. **‡πÉ‡∏ä‡πâ TypeScript ‡πÅ‡∏ö‡∏ö strict**  
3. **‡πÉ‡∏ä‡πâ composables ‡πÅ‡∏ó‡∏ô Pinia**  
4. **‡πÉ‡∏ä‡πâ Vuetify 3 + Nuxt 3 best practices**  
5. **‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ JSDoc**  
6. **‡∏ó‡∏∏‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ test stub (unit-ready)**  
7. **‡∏ï‡πâ‡∏≠‡∏á commit ‡∏á‡∏≤‡∏° ‡πÜ ‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£**  
8. **‡∏´‡πâ‡∏≤‡∏°‡∏•‡∏ö‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÄ‡∏Å‡πà‡∏≤‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á**  

---

# üì¶ DELIVERABLES
Claude ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞ commit:

### 1. Composables ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- `useDashboard.ts`  
- `useWallet.ts`  
- `useTopupReport.ts`  
- `useUsageReport.ts`  
- `useChargerPerformance.ts`  
- `useLineAlert.ts`  

### 2. Utils  
- `/utils/reports/kwh.ts`  
- `/utils/reports/duration.ts`  
- `/utils/reports/grouping.ts`  
- `/utils/reports/exportXlsx.ts`  
- `/utils/reports/exportPdf.ts`  

### 3. Components  
- Dashboard cards  
- Line chart  
- Heatmap  
- Charger bar chart  
- Wallet table + history drawer  

### 4. Pages  
‡∏ï‡∏≤‡∏° UI spec

### 5. LINE OAuth page + polling worker

### 6. Final QA Fixes

---

# üß™ TESTING REQUIREMENTS
Claude ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö:

- Date range filter  
- kWh calculation  
- Group by charger  
- Wallet running balance  
- LINE notify trigger  
- Export XLSX/PDF  
- Mobile responsive  

---

# üèÅ FINAL DELIVERY
‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à Claude ‡∏ï‡πâ‡∏≠‡∏á:

- ‡∏™‡πà‡∏á‡∏™‡πà‡∏á commit ‡∏û‡∏£‡πâ‡∏≠‡∏° release note  
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `DEPLOY_GUIDE.md`  
- ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å report ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö  

---

# ‚úî END OF SPEC  
Claude Code ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥ Phase 0 ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
~~~


# GPARTNER ‚Äî REPORTING & DASHBOARD MASTER PLAN  
Version: 1.0  
Scope: Partner Reporting + Dashboard + LINE Alerts  
Backend: ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Partner API ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ Backend)

---

## 1. DASHBOARD (Daily / Monthly)
- ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ / ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ  
- kWh ‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ / ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ  
- Total sessions  
- ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏ï‡∏π‡πâ  
- kWh ‡πÉ‡∏ä‡πâ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏ï‡∏π‡πâ  
- Peak hour usage (Heatmap)  
- Charging efficiency (kWh/min)

---

## 2. WALLET SUMMARY (PER PARTNER)
- Total Top-up  
- Total Usage  
- Outstanding Wallet  
- Wallet by User  
- Wallet History (ledger + running balance)

---

## 3. TOP-UP REPORT
- topUpId  
- createdAt  
- amount  
- paymentMethod  
- paymentStatus  

*‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:* ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Payment Fee ‚Üí ‡πÑ‡∏°‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì NET

---

## 4. CHARGING SESSION REPORT
- Session ID  
- Start‚ÄìEnd timestamp  
- User email  
- chargePoint  
- kWh used  
- Duration (minutes)  
- Revenue per session  

*Promotion ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Üí ‡∏ï‡∏±‡∏î‡∏≠‡∏≠‡∏Å*

---

## 5. TOP-UP VS USAGE COMPARISON
- Line graph: Top-up vs Usage  
- Outstanding trend  
- Consumption trend  
- Revenue vs Estimated cost (‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ input ‡∏à‡∏≤‡∏Å partner ‚Üí ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏ï‡∏±‡∏î‡∏≠‡∏≠‡∏Å)

---

## 6. CHARGER PERFORMANCE
- ChargePoint ID  
- Total revenue  
- Total kWh  
- Sessions count  
- Charging Utilization = sum(duration)

*‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î:*  
- ‡πÑ‡∏°‡πà‡∏°‡∏µ Offline history  
- ‡πÑ‡∏°‡πà‡∏°‡∏µ Error history

---

## 7. ELECTRICITY COST REPORT  
*‡∏ï‡∏±‡∏î‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• TOU / FT / Demand Charge ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö*

---

## 8. LINE ALERT SYSTEM
### Function:
- Partner login ‡∏Å‡∏î ‚ÄúConnect LINE Notify‚Äù
- ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡πá‡∏ö LINE access token
- Polling API `/partner/charge-point` ‡∏ó‡∏∏‡∏Å 30‚Äì60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‡∏´‡∏≤‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Online ‚Üí Offline ‡∏´‡∏£‡∏∑‡∏≠ ErrorCode ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

### Example Message:
```
Charger Alert
Station: ChiangMai-Nimman
Charger: CP-002
Status: Offline
Time: 14:22
```

---

## 9. EXPORT FUNCTIONS
- XLSX / CSV / PDF ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤ report  
- Dashboard PDF  
- Wallet Summary Excel  
- Charging Report Excel  
- Charger Performance PDF  

---

## NOT SUPPORTED (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏î‡∏≠‡∏≠‡∏Å)
- Payment Gateway Fee  
- TOU Rate / FT / Demand Charge  
- Error Log History  
- VAT report / e-tax  
- Promotion usage tracking  

---

## TIMELINE (12‚Äì16 days)
- Day 1‚Äì3: Dashboard base + API integration  
- Day 4‚Äì7: Wallet Summary + Top-up report  
- Day 8‚Äì10: Charger Performance + Heatmap  
- Day 11‚Äì13: LINE Notification  
- Day 14‚Äì16: Export, polishing, QA  


# GPARTNER UI PAGE STRUCTURE  
Version: 1.0

---

## /backend/dashboard
- Revenue card  
- kWh card  
- Sessions card  
- Line chart (Top-up vs Usage)  
- Heatmap peak hours  
- Revenue by charger (bar chart)  

---

## /backend/reports/wallet
- Summary table  
- Outstanding  
- Wallet by user  
- Wallet history drawer  

---

## /backend/reports/topups
- Table  
- Filters (date range, method, status)  
- Export XLSX  

---

## /backend/reports/usage
- Session table  
- Filters (charger, date range, user)  
- Export XLSX  

---

## /backend/reports/charger-performance
- Revenue per charger  
- kWh per charger  
- Utilization %  
- Export PDF  

---

## /backend/settings/line-connect
- ‡∏õ‡∏∏‡πà‡∏° "Connect LINE Notify"  
- ‡∏à‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (Connected / Not Connected)  


# GPARTNER API DATA MAPPING  
Version 1.0

---

## 1. Revenue Data ‚Üí `/partner/revenue`
Used for:
- Dashboard  
- Usage report  
- Charger performance  
- Wallet usage  

Fields:
- transactionId  
- startTimestamp / stopTimestamp  
- meterStart / meterStop  
- totalFinal  
- Connector.chargePoint  
- Rated.User.email  
- Station.id  

Derived:
- kWh = (meterStop - meterStart) / 1000  
- Duration = stop - start  
- Efficiency = kWh / duration  

---

## 2. Top-up Data ‚Üí `/partner/revenue/top-up`
Used for:
- Wallet summary  
- Top-up report  

Fields:
- topUpId  
- createdAt  
- totalFinal  
- paymentMethod  
- paymentStatus  

---

## 3. Charger Data ‚Üí `/partner/charge-point`
Used for:
- Realtime status  
- LINE notification  

Fields:
- chargePointId  
- ConnectorActivity.status  
- ConnectorActivity.errorCode  

---

## Polling Logic for LINE Alerts
Every 30‚Äì60 seconds:
- fetch /partner/charge-point  
- compare last status  
- if changed ‚Üí send LINE Notify  


# CLAUDE CODE IMPLEMENTATION PLAN  
Version: 1.0  
Purpose: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Claude Code ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡πä‡∏Å

---

## RULES
1. ‡πÉ‡∏ä‡πâ Nuxt 3 + Vue 3 (setup script)  
2. ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ Pinia ‚Üí ‡πÉ‡∏ä‡πâ composables ‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡πÄ‡∏î‡∏¥‡∏°  
3. ‡πÉ‡∏ä‡πâ useApi ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß  
4. UI = Vuetify 3  
5. ‡πÉ‡∏ä‡πâ dayjs ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö date handling  
6. PDF = jsPDF  
7. XLSX = SheetJS  

---

## MODULES TO CREATE

### 1) Composables  
- useDashboard()  
- useWallet()  
- useTopupReport()  
- useUsageReport()  
- useChargerPerformance()  
- useLineAlert()  

### 2) Utils  
- kWh calculator  
- duration calculator  
- trend builder  
- exportXLSX  
- exportPDF  

### 3) Components  
- DashboardCards.vue  
- LineChart.vue  
- Heatmap.vue  
- ChargerBarChart.vue  
- WalletSummaryTable.vue  
- WalletHistory.vue  
- TopupTable.vue  
- UsageTable.vue  

### 4) Pages  
‡∏ï‡∏≤‡∏° UI_PAGE_STRUCTURE.md

---

## IMPLEMENTATION ORDER
1. Integrate all partner APIs  
2. Build Dashboard data layer  
3. Build Wallet Summary  
4. Build Top-up Report  
5. Build Usage Report  
6. Build Charger Performance  
7. Add Export (XLSX/PDF)  
8. Implement LINE Notify OAuth + polling  
9. Final QA + optimize  

---

## TESTING
- Mock API responses  
- Validate all date filters  
- Validate grouping by charger  
- Validate Wallet calculations  
- Manual test LINE Alert  
